#lang racket
(require 2htdp/image)
(require 2htdp/universe)



;; 2 --- Ihre Nikolausaufgabe (20 Punkte)
(define scene
  ; definiert die Größe der Szene und die Hintergrundfarbe
  (empty-scene 700 500 (color 25 25 80)))

(define ground
  ; definiert den Schneeboden
  (crop/align "right" "top"
              1000 160
              (ellipse 1800 300 "solid" "whitesmoke")))

(define (oneStar size)
  ; definiert einen Stern
  (radial-star 8 2 size "solid" (color 255 255 153)))

(define (stars number)
  ; Sterne
  (if (> number 1)
      (underlay/offset (oneStar (random 2 20))
                       (random 700) (random 500)
                       (stars (- number 1)))
      (oneStar (random 2 20))))

(define (tree size greenColor)
  ; Hintergrundbaum
  (if (> size 0)
      (overlay/align/offset "middle" "middle"
                            (triangle size "solid" (color 0 greenColor 0))
                            0 (* size -0.4)
                            (tree (- size 15) greenColor))
      (triangle 0 "solid" (color 0 greenColor 0))))

(define (trees number)
  ; erzeugt Hintergrundbäume
  (if (> number 1)
      (overlay/offset (tree (random 100 300) (random 50 100))
                      (random 700) 0
                      (trees (- number 1)))
      (tree (random 100 300) (random 50 100))))

(define (treeLeaves size)
  ; erzeugt den Weihnachtsbaume ohne Stamm
  (if (> size 0)
      (underlay/align/offset "middle" "middle"
                             (pulled-regular-polygon size 3 1/5 30 "solid" (color 34 160 34))
                             0 (* size -0.4)
                             (treeLeaves (- size 30)))
      (star 25 "solid" "gold")))

(define christmasTree
  ; erzeugt Weihnachtsbaum mit Stamm
  (overlay/align/offset "middle" "bottom"
                        (treeLeaves 200)
                        0 10
                        (pulled-regular-polygon 50 4 1/5 30 "solid" "sienna")))

(define placeStars
  ;platziert Hintergrundbäume in Szene
  (place-image (stars 200)
               700 400
               scene))

(define placeTrees
  ;platziert Hintergrundbäume in Szene
  (place-image (trees 100)
               700 320
               placeStars))

(define placeGround
  ;platziert Boden in Szene
  (place-image/align ground
                     0 500
                     "left" "bottom"
                     placeTrees))

(define placeChristmasTree
  ;platziert Weihnachstsbaum in Szene
  (place-image/align christmasTree
                     200 275
                     "middle" "middle"
                     placeGround))

(define createScene
  placeChristmasTree)

; erzeugt das Bild:
createScene



;; Zusatzaufgabe: Animation (Schneefall?)

