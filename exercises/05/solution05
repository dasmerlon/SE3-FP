#lang racket
(require se3-bib/butterfly-module)

;; Blatt 5

;; 1 --- Mendels Land
; (show-butterfly 'red 'dots 'straight 'hexagon)
; (show-butterfly 'yellow 'star 'straight 'ellipse)
; (show-butterfly 'blue 'star 'curly 'rhomb)

;; 1.1 - Analyse und Grobentwurf (12 Punkte)
#|
zu lösende Teilprobleme:
- anhand der dominanten Merkmale die rezessiven Merkmale der Eltern bestimmen
- die zu vererbenden Merkmale der Eltern bestimmen (zufällig: dominante oder rezessive)
- bestimmen der Anzahl der Kinder
- bestimmen der dominanten Merkmale von Kindern
- anzeigen der Schmetterlinge (Eltern und Kinder)

Gliederung:
1. createRecessiveFeatures
   Input:
     - dominante Merkmale (Musterung, Flügelfarbe, Fühlerform, Flügelform) des Elternteils
   Aufgabe:
     - ermittelt anhand der dominanten Merkmale und der Dominanzregeln zufällige rezessive
       Merkmale    
   Output:
     - rezessive Merkmale (Musterung, Flügelfarbe, Fühlerform, Flügelform) des Elternteils

2. selectFeatures
   Input:
     - dominante Merkmale (Musterung, Flügelfarbe, Fühlerform, Flügelform) des Elternteils
     - rezessive Merkmale (Musterung, Flügelfarbe, Fühlerform, Flügelform) des Elternteils
   Aufgabe:
     - wählt aus den dominanten und rezessiven Merkmalen zufällig jeweils eines
       der Merkmalarten aus 
   Output:
     - die zu vererbenden Merkmale (Musterung, Flügelfarbe, Fühlerform, Flügelform)
       eines Elternteils

3. createKidsFeatures
   Input:
     - die zu vererbenden Merkmale (Musterung, Flügelfarbe, Fühlerform, Flügelform)
       der Mutter
     - die zu vererbenden Merkmale (Musterung, Flügelfarbe, Fühlerform, Flügelform)
       des Vaters 
   Aufgabe:
     - ermittelt anhand der zu vererbenden Merkmale der Eltern und der Dominanzregeln
       die sichtbaren dominanten Merkmale des Kindes
   Output:
     - dominante Merkmale (Musterung, Flügelfarbe, Fühlerform, Flügelform) des Kindes

4. showButterflies
   Input:
     - dominante Merkmale (Musterung, Flügelfarbe, Fühlerform, Flügelform)
       der Mutter
     - dominante Merkmale (Musterung, Flügelfarbe, Fühlerform, Flügelform)
       des Vaters 
   Aufgabe:
     - zeigt die Schmetterlinge an

5. mendel (Hauptfunktion)
   Input:
     - dominante Merkmale (Musterung, Flügelfarbe, Fühlerform, Flügelform) der Mutter
     - dominante Merkmale (Musterung, Flügelfarbe, Fühlerform, Flügelform) des Vaters
     - Anzahl zu erzeugender Kinder
   Aufgabe:
     - erzeugt die richtige Anzahl der Kinder und leitet die Erzeugung deren Merkmale ein
   Output: Bilder von Eltern und Kindern


Datenstruktur zum Speichern des Genoms:
Die Datenstruktur ist eine Liste von Listen, bei der das erste Element jeweils ein Merkmal
und deren zweites Element jeweils eine Liste von Merkmalen darstellt, welche dem ersten
Merkmal unterlegen sind. Heißt: Das Merkmal an erster Stelle dominiert die Merkmale aus der
nachfolgenden Liste.

Begründung:
TODO
|#


;; 1.2 - Implementation und Erprobung (18 Punkte)
(define dominanceRules
  ; Datenstruktur der Dominanzregeln, wobei der Wert immer eine Liste all jener Merkmale ist,
  ; die von dem Schlüssel dominiert werden
  '((star . (dots stripes))
    (dots . (stripes))
    (stripes . (stripes))
    (red . (green blue yellow))
    (green . (blue yellow))
    (blue . (yellow))
    (yellow . (yellow))
    (curved . (straight curly))
    (straight . (curly))
    (curly . (curly))
    (ellipse . (hexagon rhomb))
    (hexagon . (rhomb))
    (rhomb . (rhomb))))


;; 2 --- Ein Vaterschaftstest (6 Zusatzpunkte)